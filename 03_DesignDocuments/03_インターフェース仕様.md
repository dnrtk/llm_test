# インターフェース仕様

## 1. モジュール間インターフェース

### 1.1. UIモジュール - 画面認識モジュール間インターフェース
- **インターフェース名**: `get_game_board`
- **概要**: UIモジュールから画面認識モジュールへゲーム盤面データの取得を要求するインターフェースです。
- **リクエスト**:
    - なし
- **レスポンス**:
    - `game_board_data`: ゲーム盤面データ (データ構造は「2. データ構造」で定義)
    - エラー情報 (エラー 발생 시)
- **処理の流れ**:
    1. UIモジュールは、解析開始ボタン押下などのイベントをトリガーに、画面認識モジュールへ `get_game_board` リクエストを送信します。
    2. 画面認識モジュールは、画面キャプチャ、盤面認識処理を実行し、ゲーム盤面データを生成します。
    3. 画面認識モジュールは、生成したゲーム盤面データをレスポンスとしてUIモジュールへ返却します。
    4. 画面認識処理に失敗した場合、エラー情報をレスポンスとしてUIモジュールへ返却します。

### 1.2. 画面認識モジュール - ゲーム解析モジュール間インターフェース
- **インターフェース名**: `analyze_best_move`
- **概要**: 画面認識モジュールからゲーム解析モジュールへ最適手解析を要求するインターフェースです。
- **リクエスト**:
    - `game_board_data`: ゲーム盤面データ (データ構造は「2. データ構造」で定義)
- **レスポンス**:
    - `best_move`: 最適手情報 (データ構造は「2. データ構造」で定義)
    - エラー情報 (エラー 발생 시)
- **処理の流れ**:
    1. 画面認識モジュールは、盤面認識処理で取得したゲーム盤面データを引数として、ゲーム解析モジュールへ `analyze_best_move` リクエストを送信します。
    2. ゲーム解析モジュールは、最適手解析アルゴリズムを実行し、最適手を決定します。
    3. ゲーム解析モジュールは、決定した最適手情報をレスポンスとして画面認識モジュールへ返却します。
    4. 解析処理に失敗した場合、エラー情報をレスポンスとして画面認識モジュールへ返却します。

### 1.3. ゲーム解析モジュール - UIモジュール間インターフェース
- **インターフェース名**: `display_analysis_result`
- **概要**: ゲーム解析モジュールからUIモジュールへ解析結果（最適手）の表示を指示するインターフェースです。
- **リクエスト**:
    - `analysis_result`: 解析結果情報 (データ構造は「2. データ構造」で定義)
- **レスポンス**:
    - なし
- **処理の流れ**:
    1. ゲーム解析モジュールは、最適手解析処理完了後、解析結果情報を引数として、UIモジュールへ `display_analysis_result` リクエストを送信します。
    2. UIモジュールは、受け取った解析結果情報に基づき、画面上に解析結果をオーバーレイ表示します。

### 1.4. UIモジュール - 設定モジュール間インターフェース
- **インターフェース名**: `get_setting`, `set_setting`
- **概要**: UIモジュールから設定モジュールへ設定情報の取得、設定変更を要求するインターフェースです。
- **リクエスト**:
    - `get_setting`:
        - `setting_name`: 取得したい設定項目名
    - `set_setting`:
        - `setting_name`: 設定変更したい項目名
        - `setting_value`: 設定値
- **レスポンス**:
    - `get_setting`:
        - `setting_value`: 設定値
        - エラー情報 (エラー 발생 시)
    - `set_setting`:
        - 成功/失敗 情報
        - エラー情報 (失敗 시)
- **処理の流れ**:
    1. UIモジュールは、設定画面表示時などに、設定モジュールへ `get_setting` リクエストを送信し、設定値を取得します。
    2. 設定モジュールは、設定値をレスポンスとしてUIモジュールへ返却します。
    3. UIモジュールは、設定変更操作時に、設定モジュールへ `set_setting` リクエストを送信し、設定変更を要求します。
    4. 設定モジュールは、設定変更処理を実行し、成功/失敗情報をレスポンスとしてUIモジュールへ返却します。

## 2. データ構造
各インターフェースで 伝達される 主要なデータ構造を以下に定義します。

- **`game_board_data`**: ゲーム盤面データ
    - 型: 2次元配列 (ピースの種類を表す数値 または 文字列)
    - 例: `[[1, 2, 3, 1, 2], [2, 3, 1, 2, 3], [3, 1, 2, 3, 1], [1, 2, 3, 1, 2], [2, 3, 1, 2, 3]]`

- **`best_move`**: 最適手情報
    - 型: オブジェクト
    - プロパティ:
        - `from_row`: 移動元ピースの行 インデックス
        - `from_col`: 移動元ピースの列 インデックス
        - `to_row`: 移動先ピースの行 インデックス
        - `to_col`: 移動先ピースの列 インデックス
    - 例: `{from_row: 2, from_col: 1, to_row: 2, to_col: 2}` (3行目2列目のピースを3行目3列目へ移動)

- **`analysis_result`**: 解析結果情報
    - 型: オブジェクト
    - プロパティ:
        - `best_move`: 最適手情報 (`best_move` データ構造)
        - `score`: 評価値 (最適手の評価値)
        - `analysis_time`: 解析時間 (ミリ秒)
    - 例: `{best_move: {from_row: 2, from_col: 1, to_row: 2, to_col: 2}, score: 120, analysis_time: 350}`

- **`setting_value`**: 設定値
    - 型: 文字列 または 数値 または 真偽値 (設定項目による)
    - 例: `"ja"`, `5`, `true`

## 3. エラー処理
各インターフェースでのエラー発生時には、エラー情報をレスポンスとして 伝達 します。
エラー情報は、エラーコードとエラーメッセージを含むオブジェクトとします。

- **エラー情報**:
    - 型: オブジェクト
    - プロパティ:
        - `error_code`: エラーコード (数値 または 文字列)
        - `error_message`: エラーメッセージ (エラー 詳細 を記述)
    - 例: `{error_code: "BOARD_RECOGNITION_FAILED", error_message: "盤面認識に失敗しました"}`

## 4. 今後の課題
- 各インターフェースの より詳細な 仕様 (パラメータの型、 必須項目 など)
- エラーコード 詳細 の 仕様
- インターフェース 実装 方法 (プロセス間通信、API コマンド など) の 検討
